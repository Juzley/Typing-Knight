<!DOCTYPE HTML>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title></title>
	<script type="text/javascript" src="src/Convert.js"></script>
	<script type="text/javascript" src="src/Stage.js"></script>
	<script type="text/javascript" src="src/Veggie.js"></script>
	<script type="text/javascript" src="src/VeggieFactory.js"></script>
	<link rel="stylesheet" href="bootstrap.yeti.min.css" />
	<script>
		window.onload = function(){
			(function(){
				var stage = new Stage(
					document.getElementById('canvas1'),
					document.getElementById('img'),
					500,200);
				stage.init();
				var veggies = new VeggieFactory.fullSet();
				veggies.forEach(function(veggie,i){
					veggie.pos.x = 80 * (i + 1);
					veggie.pos.y = 80;
					stage.veggies.push(veggie);
				});
				stage.draw();
			})();
			(function(){
				var stage = new Stage(
					document.getElementById('canvas2'),
					document.getElementById('img'),
					500,200);
				stage.init();
				var veggies = new VeggieFactory.fullSplitSet();
				veggies.forEach(function(veggie,i){
					veggie.pos.x = 50 * (i + .5);
					veggie.pos.y = 80;
					stage.veggies.push(veggie);
				});
				stage.draw();
			})();
			(function(){
				[3,4,5,6,7,8,9,10].forEach(function(n,testIndex){
					var canvas = document.getElementById('canvas' + n);
					var stage = new Stage(
						canvas,
						document.getElementById('img'),
						500,200);
					stage.init();
					var veggies = new VeggieFactory.fullSet();
					veggies.forEach(function(veggie,i){
						veggie.pos.x = 100 * (i + 0.5);
						veggie.pos.y = 80;
						stage.veggies.push(veggie);
						veggie.rot = 45 * testIndex;
					});
					stage.draw();
					var split = false;
					setInterval(function(){
						if(split){//put them back together
							stage.veggies = veggies.slice(0);
						} else {//take them apart
							veggies.forEach(function(veggie){
								stage.splitVeggie(veggie);
							});
						}
						split = !split;
						stage.draw();
					}, 1000);
				});
			})();
			(function(){
				var canvas = document.getElementById('canvas11');
				var stage = new Stage(
					canvas,
					document.getElementById('img'),
					500,200);
				stage.init();
				var veggies = new VeggieFactory.fullSet();
				veggies.forEach(function(veggie,i){
					veggie.pos.x = 80 * (i + 1);
					veggie.pos.y = 80;
					stage.veggies.push(veggie);
				});
				stage.draw();
				canvas.addEventListener('click',function(e){
					//console.log('click on canvas:', e.offsetX, e.offsetY);
					var clickedVeggies = stage.getVeggiesAt(e.offsetX, e.offsetY)
					if(clickedVeggies.length == 0){
						console.log('no veggies clicked');
					} else {
						var clickedVeggieNames = clickedVeggies.map(function(veggie){
							return veggie.type;
						});
						console.log('clicked veggies:',clickedVeggieNames);
						clickedVeggies.forEach(function(veggie){
							console.log(veggie);
							stage.splitVeggie(veggie);
						});
						stage.draw();
						var wholeVeggiesLeft = stage.veggies.filter(function(veggie){
							return veggie.whole;
						});
						if(wholeVeggiesLeft.length == 0){
							setTimeout(function(){
								stage.veggies = veggies;
								stage.draw();
							},500);
						}
					}
				});
			})();
		};
	</script>
</head>
<body>
	<div class="container">
		<div class="page-header">
			<a href="index.html">Index</a>
		</div>
		<div class="row">
			<div class="col-md-8">
				<img id="img" src="vegetables.png" style="display:none;"/>
				<div class="row">
					<div class="col-md-4">
						Static display of all veggies
					</div>
					<div class="col-md-8">
						<canvas id="canvas1"></canvas>
					</div>
				</div>
				<div class="row">
					<div class="col-md-4">
						Static display of all splits
					</div>
					<div class="col-md-8">
						<canvas id="canvas2"></canvas>
					</div>
				</div>
				<div class="row">
					<div class="col-md-4">
						Toggle between whole and split
					</div>
					<div class="col-md-8">
						<canvas id="canvas3"></canvas>
						<canvas id="canvas4"></canvas>
						<canvas id="canvas5"></canvas>
						<canvas id="canvas6"></canvas>
						<canvas id="canvas7"></canvas>
						<canvas id="canvas8"></canvas>
						<canvas id="canvas9"></canvas>
						<canvas id="canvas10"></canvas>
					</div>
				</div>
				<div class="row">
					<div class="col-md-4">
						Veggies should split when clicked
					</div>
					<div class="col-md-8">
						<canvas id="canvas11"></canvas>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>
</html>

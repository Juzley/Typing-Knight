<!DOCTYPE HTML>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<script type="text/javascript" src="src/Controls.js"></script>
	<script type="text/javascript" src="src/Convert.js"></script>
	<script type="text/javascript" src="src/GameLoop.js"></script>
	<script type="text/javascript" src="src/Stage.js"></script>
	<script type="text/javascript" src="src/Veggie.js"></script>
	<script type="text/javascript" src="src/VeggieFactory.js"></script>
	<script type="text/javascript" src="src/VeggieLauncher.js"></script>
	<script type="text/javascript" src="src/ComboNotice.js"></script>
	<script type="text/javascript" src="src/ScoreBoard.js"></script>
	<script type="text/javascript" src="src/PauseScreen.js"></script>
	<script type="text/javascript" src="lib/jquery-1.11.1.min.js"></script>
	<link rel="stylesheet" href="bootstrap.yeti.min.css" />
	<meta name="viewport" content="width=device-width, user-scalable=no">
	<title>Salad Knight</title>
	<script>
		window.onload = function(){
			var canvas = document.getElementById('canvas');
			var stage = new Stage(
				canvas,
				document.getElementById('img'),
				500,300,
				document.getElementById('rays'));
			var gameLoop = new GameLoop(stage);
			var veggieLauncher = new VeggieLauncher(stage);
			var controls = new Controls(canvas,stage,gameLoop,veggieLauncher);
			var scoreBoard = new ScoreBoard(controls,stage);
			var pauseScreen = new PauseScreen(canvas,scoreBoard,gameLoop);
			stage.init();
			controls.init();
			scoreBoard.init();
			stage.draw();
			pauseScreen.init();
			controls.on('combo',function(comboSize,x,y){
				stage.notices.push(new ComboNotice(comboSize,x,y));
			});
			function launch(){
				veggieLauncher.randomLaunch(VeggieFactory.randomSet());
			}
			setInterval(function(){
				if(gameLoop.isRunning()){
					launch();
				}
			}, 2500)
			gameLoop.on('start',function(){
				launch();
			});
			$('#playPause').on('touch click',function(){
				gameLoop.playPause();
			});
			$('#fullscreen').on('touch click',function(){
				requestFullscreen(canvas);
			});
			bgtest();
		};
		function requestFullscreen(elem){
			if (elem.requestFullscreen) {
			  elem.requestFullscreen();
			} else if (elem.msRequestFullscreen) {
			  elem.msRequestFullscreen();
			} else if (elem.mozRequestFullScreen) {
			  elem.mozRequestFullScreen();
			} else if (elem.webkitRequestFullscreen) {
			  elem.webkitRequestFullscreen();
			}
		}
	</script>
</head>
<body>
	<img src="img/bg-pinwheel-rays-green-1000.png" id="rays" style="display:none;">
	<div class="container text-center">
		<img src="img/VeggieKnight.gif" class="img-responsive" style="margin:0 auto;">
		<hr>
		<p class="lead">It's like <a href="http://fruitninja.com/">Fruit Ninja</a> but with Veggies</p>
		<hr>
		<img id="img" src="img/veggies.png" style="display:none;"/>
		<button id="playPause">Play/Pause</button>
		<button id="fullscreen">Full Screen</button>
		<br>
		<br>
		<canvas id="canvas"></canvas>
		<br>
		<br>
		<kbd>Space</kbd> Play/Pause
		<span style="padding:0 1em;" class="text-muted">&bull;</span>
		<kbd>Swipe</kbd> Slice veggies
		<br>
		<br>
		<br>
		<a href="test.html">Tests</a>
	</div>
</body>
</html>
